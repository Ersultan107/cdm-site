<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–≠–ö | –°—Ç—É–¥–µ–Ω—á–µ—Å–∫–∏–π –ü–æ—Ä—Ç–∞–ª –ö–î–ú</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script>
        tailwind.config = { darkMode: 'class' }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeIn 0.5s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .glass-header { backdrop-filter: blur(10px); background: rgba(30, 64, 175, 0.9); }
        .dark .glass-header { background: rgba(15, 23, 42, 0.9); }
    </style>
</head>
<body class="bg-gray-50 dark:bg-[#0b0f1a] text-slate-800 dark:text-slate-200 transition-colors duration-300">

    <audio id="login-sound" src="https://assets.mixkit.co/active_storage/sfx/2571/2571-preview.mp3"></audio>

    <div id="auth-screen" class="fixed inset-0 z-[100] bg-[#020617] flex items-center justify-center p-6 transition-all duration-1000">
        <div class="w-full max-w-md text-center">
            <div class="mb-8 inline-block p-6 bg-blue-600 rounded-[35px] shadow-2xl animate-pulse">
                <i class="fas fa-university text-5xl text-white"></i>
            </div>
            <h2 class="text-white text-4xl font-black mb-2 tracking-tighter">–ê–≠–ö –ü–û–†–¢–ê–õ</h2>
            <p class="text-blue-400 font-medium mb-10 italic">Almaty Economic College ‚Ä¢ KDM</p>
            
            <div class="space-y-4">
                <input type="text" id="user-name" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è" class="w-full p-5 rounded-3xl bg-white/5 border border-white/10 text-white outline-none focus:border-blue-500 transition-all text-center font-bold">
                <input type="text" id="user-group" placeholder="–í–∞—à–∞ –≥—Ä—É–ø–ø–∞ (–Ω–∞–ø—Ä. –ò–° 2-1)" class="w-full p-5 rounded-3xl bg-white/5 border border-white/10 text-white outline-none focus:border-blue-500 transition-all text-center font-bold uppercase tracking-widest">
            </div>
            <button onclick="handleLogin()" class="w-full mt-8 bg-blue-600 text-white py-5 rounded-3xl font-black text-xl shadow-lg hover:bg-blue-500 transition-all active:scale-95">–í–û–ô–¢–ò –í –ü–û–†–¢–ê–õ</button>
        </div>
    </div>

    <div id="main-app" class="hidden">
        <header class="fixed top-0 left-0 right-0 z-50 glass-header text-white px-6 py-4 border-b border-white/10">
            <div class="max-w-6xl mx-auto flex justify-between items-center">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-white/20 rounded-xl flex items-center justify-center font-black">–ê–≠–ö</div>
                    <div>
                        <p id="display-name" class="font-bold text-sm leading-none">–°—Ç—É–¥–µ–Ω—Ç</p>
                        <p id="display-group" class="text-[9px] opacity-60 font-black uppercase">–ì—Ä—É–ø–ø–∞</p>
                    </div>
                </div>
                <button onclick="toggleDark()" class="w-10 h-10 rounded-xl bg-white/10 flex items-center justify-center">
                    <i id="theme-icon" class="fas fa-moon"></i>
                </button>
            </div>
        </header>

        <main class="pt-24 pb-24 px-6 max-w-6xl mx-auto">
            
            <div class="flex overflow-x-auto gap-3 mb-10 pb-2 no-scrollbar">
                <button onclick="switchTab('info')" class="px-8 py-4 rounded-2xl bg-white dark:bg-slate-800 shadow-sm font-bold text-sm flex-shrink-0 border border-transparent dark:border-slate-700 active:scale-95 transition-all">üè† –ì–ª–∞–≤–Ω–∞—è</button>
                <button onclick="switchTab('team')" class="px-8 py-4 rounded-2xl bg-white dark:bg-slate-800 shadow-sm font-bold text-sm flex-shrink-0 border border-transparent dark:border-slate-700 active:scale-95 transition-all">üë• –ö–æ–º–∞–Ω–¥–∞</button>
                <button onclick="switchTab('rating')" class="px-8 py-4 rounded-2xl bg-white dark:bg-slate-800 shadow-sm font-bold text-sm flex-shrink-0 border border-transparent dark:border-slate-700 active:scale-95 transition-all">üèÜ –†–µ–π—Ç–∏–Ω–≥</button>
                <button onclick="switchTab('quests')" class="px-8 py-4 rounded-2xl bg-white dark:bg-slate-800 shadow-sm font-bold text-sm flex-shrink-0 border border-transparent dark:border-slate-700 active:scale-95 transition-all">‚ö° –ö–≤–µ—Å—Ç—ã</button>
            </div>

            <section id="tab-info" class="tab-content active space-y-6">
                <div class="bg-blue-600 text-white p-8 rounded-[40px] shadow-xl relative overflow-hidden">
                    <h2 class="text-3xl font-black mb-4 relative z-10 uppercase italic">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –ê–≠–ö</h2>
                    <p class="opacity-90 text-sm leading-relaxed relative z-10">–ê–ª–º–∞—Ç–∏–Ω—Å–∫–∏–π –≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π –ö–æ–ª–ª–µ–¥–∂ ‚Äî —ç—Ç–æ –º–µ—Å—Ç–æ, –≥–¥–µ —Ä–æ–∂–¥–∞—é—Ç—Å—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—ã. –ú—ã –æ–±—ä–µ–¥–∏–Ω—è–µ–º —Ç—Ä–∞–¥–∏—Ü–∏–∏ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ü–∏—Ñ—Ä–æ–≤—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏. –ö–î–ú ‚Äî —ç—Ç–æ —Å–µ—Ä–¥—Ü–µ –Ω–∞—à–µ–π —Å—Ç—É–¥–µ–Ω—á–µ—Å–∫–æ–π –∂–∏–∑–Ω–∏.</p>
                    <i class="fas fa-graduation-cap absolute -right-4 -bottom-4 text-9xl opacity-10"></i>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-white dark:bg-slate-800 p-8 rounded-[40px] shadow-sm border border-gray-100 dark:border-slate-700">
                        <h3 class="font-black text-xl mb-4 flex items-center gap-3">
                            <i class="fas fa-flag text-blue-500"></i> –ú–∏—Å—Å–∏—è –ö–î–ú
                        </h3>
                        <p class="text-sm opacity-70 leading-relaxed">–ö–æ–º–∏—Ç–µ—Ç –ø–æ –¥–µ–ª–∞–º –º–æ–ª–æ–¥–µ–∂–∏ (–ö–î–ú) ‚Äî —ç—Ç–æ –æ—Ä–≥–∞–Ω —Å—Ç—É–¥–µ–Ω—á–µ—Å–∫–æ–≥–æ —Å–∞–º–æ—É–ø—Ä–∞–≤–ª–µ–Ω–∏—è. –ù–∞—à–∞ —Ü–µ–ª—å: —Å–¥–µ–ª–∞—Ç—å —Ç–≤–æ–µ –æ–±—É—á–µ–Ω–∏–µ —è—Ä–∫–∏–º, –∑–∞—â–∏—Ç–∏—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å—ã —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –∏ —Ä–∞–∑–≤–∏—Ç—å –ª–∏–¥–µ—Ä—Å–∫–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –≤ –∫–∞–∂–¥–æ–º.</p>
                    </div>
                    <div class="bg-white dark:bg-slate-800 p-8 rounded-[40px] shadow-sm border border-gray-100 dark:border-slate-700">
                        <h3 class="font-black text-xl mb-4 flex items-center gap-3">
                            <i class="fas fa-star text-yellow-500"></i> –ß—Ç–æ –º—ã –¥–µ–ª–∞–µ–º?
                        </h3>
                        <ul class="text-sm opacity-70 space-y-2">
                            <li>‚Ä¢ –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –º–∞—Å—à—Ç–∞–±–Ω—ã—Ö –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π</li>
                            <li>‚Ä¢ –†–∞–∑–≤–∏—Ç–∏–µ —Å–ø–æ—Ä—Ç–∏–≤–Ω—ã—Ö –∏ —Ç–≤–æ—Ä—á–µ—Å–∫–∏—Ö —Å–µ–∫—Ü–∏–π</li>
                            <li>‚Ä¢ –í–æ–ª–æ–Ω—Ç–µ—Ä—Å–∫–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ "–î–æ–±—Ä–æ–µ —Å–µ—Ä–¥—Ü–µ"</li>
                            <li>‚Ä¢ –°–æ—Ü–∏–∞–ª—å–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section id="tab-team" class="tab-content">
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6" id="team-list"></div>
            </section>

            <section id="tab-rating" class="tab-content">
                <div class="bg-white dark:bg-slate-800 p-10 rounded-[50px] shadow-xl border border-gray-100 dark:border-slate-700 max-w-2xl mx-auto">
                    <h2 class="text-center font-black text-2xl mb-10 tracking-widest uppercase italic">–¢–æ–ø –ê–∫—Ç–∏–≤–∏—Å—Ç–æ–≤</h2>
                    <div id="leaderboard" class="space-y-4"></div>
                </div>
            </section>

            <section id="tab-quests" class="tab-content">
                <div id="quests-list" class="grid gap-4 max-w-3xl mx-auto"></div>
            </section>

        </main>
    </div>

    <script>
        const SHEET_ID = '1BEi1MzL4-2vTVGa_2yyYnVkkDcSch6GIZKeWUHRYFxY';

        function handleLogin() {
            const name = document.getElementById('user-name').value;
            const group = document.getElementById('user-group').value.toUpperCase();
            if(name.length > 2 && group.includes('-')) {
                document.getElementById('login-sound').play();
                localStorage.setItem('aec_u', name);
                localStorage.setItem('aec_g', group);
                document.getElementById('auth-screen').style.opacity = '0';
                setTimeout(() => showApp(name, group), 600);
            }
        }

        function showApp(name, group) {
            document.getElementById('auth-screen').classList.add('hidden');
            document.getElementById('main-app').classList.remove('hidden');
            document.getElementById('display-name').innerText = name;
            document.getElementById('display-group').innerText = group;
            loadData();
        }

        function toggleDark() {
            document.documentElement.classList.toggle('dark');
            const isDark = document.documentElement.classList.contains('dark');
            document.getElementById('theme-icon').className = isDark ? 'fas fa-sun' : 'fas fa-moon';
            localStorage.setItem('aec_theme', isDark ? 'dark' : 'light');
        }

        function switchTab(id) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.getElementById('tab-'+id).classList.add('active');
            window.scrollTo({top: 0, behavior: 'smooth'});
        }

        async function loadData() {
            const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&gid=0&t=${Date.now()}`;
            const res = await fetch(url);
            const text = await res.text();
            const json = JSON.parse(text.substring(47).slice(0, -2));
            const rows = json.table.rows;

            // –ö–û–ú–ê–ù–î–ê
            document.getElementById('team-list').innerHTML = rows.slice(1).map(r => {
                if(!r.c[0]?.v) return '';
                return `
                <div class="bg-white dark:bg-slate-800 p-8 rounded-[45px] shadow-sm hover:shadow-xl transition-all border border-gray-100 dark:border-slate-700">
                    <div class="flex items-center gap-4 mb-6">
                        <div class="w-12 h-12 bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 rounded-2xl flex items-center justify-center font-black">${r.c[0].v.charAt(0)}</div>
                        <div>
                            <h3 class="font-black text-lg leading-none">${r.c[0].v}</h3>
                            <p class="text-[9px] font-black text-blue-500 uppercase mt-1 tracking-tighter">${r.c[1]?.v || ''}</p>
                        </div>
                    </div>
                    <p class="opacity-50 text-xs leading-relaxed italic">"${r.c[2]?.v || '–ê–≠–ö ‚Äî —Å–∏–ª–∞ –≤ –µ–¥–∏–Ω—Å—Ç–≤–µ!'}"</p>
                </div>`;
            }).join('');

            // –†–ï–ô–¢–ò–ù–ì
            const sorted = rows.slice(1).filter(r => r.c[4]?.v).map(r => ({ n: r.c[4].v, s: r.c[5]?.v || 0 })).sort((a,b)=>b.s - a.s);
            document.getElementById('leaderboard').innerHTML = sorted.map((p, i) => `
                <div class="flex justify-between items-center p-6 rounded-[30px] ${i==0 ? 'bg-amber-50 dark:bg-amber-900/20 border border-amber-200' : 'bg-gray-50 dark:bg-slate-900/40'}">
                    <div class="flex items-center gap-4">
                        <span class="w-8 h-8 flex items-center justify-center font-black ${i==0 ? 'text-amber-500' : 'opacity-20'}">
                            ${i==0 ? '<i class="fas fa-crown"></i>' : i+1}
                        </span>
                        <span class="font-bold text-sm">${p.n}</span>
                    </div>
                    <span class="bg-blue-600 text-white px-4 py-1.5 rounded-xl font-black text-[10px] shadow-md">${p.s} –ë–ê–õ–õ–û–í</span>
                </div>`).join('');

            // –ö–í–ï–°–¢–´
            document.getElementById('quests-list').innerHTML = rows.slice(1).filter(r => r.c[7]?.v).map(r => `
                <div class="bg-white dark:bg-slate-800 p-7 rounded-[35px] shadow-sm border border-gray-100 dark:border-slate-700 flex justify-between items-center hover:scale-[1.02] transition-all">
                    <h4 class="font-bold text-sm">${r.c[7].v}</h4>
                    <span class="text-emerald-500 font-black text-sm">+${r.c[8]?.v || 0} –ë</span>
                </div>`).join('');
        }

        window.onload = () => {
            if(localStorage.getItem('aec_theme') === 'dark') toggleDark();
            const u = localStorage.getItem('aec_u'); const g = localStorage.getItem('aec_g');
            if(u) showApp(u, g);
        }
    </script>
</body>
</html>
